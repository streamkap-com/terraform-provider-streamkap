## Codebase Patterns
- The `docs/audits/` directory contains reference documentation
- Go build command: `go build ./...` for typechecking
- Branch naming: PRD specifies `ralph/conditional-validation-struct-alignment` branch
- Backend configuration files are at: /Users/alexandrubodea/Documents/Repositories/python-be-streamkap/app/{sources,destinations,transforms}/plugins/{connector}/configuration.latest.json
- Generated schema files are in `internal/generated/` with DO NOT EDIT markers
- Wrapper files are in `internal/resource/source/*_generated.go` and `internal/resource/destination/*_generated.go`
- deprecations.json and overrides.json in cmd/tfgen/ control field deprecations and type overrides
- Every struct field with `tfsdk` tag MUST have a matching schema attribute (Terraform Plugin Framework requirement)
- Fields with `conditions` array AND `required: true` in backend config should be `Optional` in Terraform with documentation noting conditional requirement
- PostgreSQL already has deprecated fields correctly implemented with DeprecationMessage and field mappings

---

## 2026-01-22 - US-003
- What was implemented:
  - Audited MySQL source conditional fields from backend configuration.latest.json
  - Compared backend conditional requirements with current Terraform schema
  - Found MySQL schema is ALREADY CORRECTLY IMPLEMENTED
- Files changed:
  - Updated: `tasks/progress.txt`
  - Updated: `tasks/prd.json`
- **Learnings for future iterations:**
  - MySQL uses `snapshot.gtid` instead of `snapshot.read.only.user.defined` for the read-only toggle
  - MySQL `signal.data.collection.schema.or.database` is NOT required (vs PostgreSQL which has required:true)
  - MySQL `heartbeat.data.collection.schema.or.database` is required when conditions met (same as PostgreSQL)
  - SSH conditional fields follow the same pattern as PostgreSQL

### MySQL Conditional Fields Audit

| Backend Field | Required | Conditions | TF Status | Correct? |
|---------------|----------|------------|-----------|----------|
| `signal.data.collection.schema.or.database` | No | `snapshot_gtid == "No"` | Optional | YES |
| `heartbeat.data.collection.schema.or.database` | Yes | `heartbeat_enabled AND snapshot_gtid == "No"` | Optional (with condition doc) | YES |
| `column.include.list.user.defined` | No | `column.include.list.toggled == true` | Optional | YES |
| `column.exclude.list.user.defined` | No | `column.include.list.toggled == false` | Optional | YES |
| `ssh.host` | No | `ssh.enabled == true` | Optional | YES |
| `ssh.port` | No | `ssh.enabled == true` | Optional (default: 22) | YES |
| `ssh.user` | No | `ssh.enabled == true` | Optional (default: "streamkap") | YES |
| `ssh.public.key.user.displayed` | No | `ssh.enabled == true` | Optional | YES |

---

## 2026-01-22 - US-001
- What was implemented:
  - Audited PostgreSQL source conditional fields from backend configuration.latest.json
  - Compared backend conditional requirements with current Terraform schema
  - Found PostgreSQL schema is ALREADY CORRECTLY IMPLEMENTED
- Files changed:
  - Updated: `tasks/progress.txt`
  - Updated: `tasks/prd.json` (converted from PRD markdown)
- **Learnings for future iterations:**
  - Backend config path: `/Users/alexandrubodea/Documents/Repositories/python-be-streamkap/app/sources/plugins/postgresql/configuration.latest.json`
  - Fields with `conditions` array show conditional visibility/requirement
  - Two PostgreSQL fields have `required: true` with conditions:
    - `signal.data.collection.schema.or.database`: Required when `snapshot.read.only.user.defined == "No"`
    - `heartbeat.data.collection.schema.or.database`: Required when `heartbeat.enabled == true` AND `snapshot.read.only.user.defined == "No"`
  - Current Terraform schema correctly marks these as Optional with documentation about conditional requirements
  - Deprecated fields are correctly implemented with DeprecationMessage and field mappings

### PostgreSQL Conditional Fields Audit

| Backend Field | Required | Conditions | TF Status | Correct? |
|---------------|----------|------------|-----------|----------|
| `signal.data.collection.schema.or.database` | Yes | `snapshot_read_only == "No"` | Optional (default: "public") | YES |
| `heartbeat.data.collection.schema.or.database` | Yes | `heartbeat_enabled AND snapshot_read_only == "No"` | Optional | YES |
| `column.include.list.user.defined` | No | `column.include.list.toggled == true` | Optional | YES |
| `column.exclude.list.user.defined` | No | `column.include.list.toggled == false` | Optional | YES |
| `ssh.host` | No | `ssh.enabled == true` | Optional | YES |
| `ssh.port` | No | `ssh.enabled == true` | Optional (default: 22) | YES |
| `ssh.user` | No | `ssh.enabled == true` | Optional (default: "streamkap") | YES |
| `ssh.public.key.user.displayed` | No | `ssh.enabled == true` | Optional | YES |

---

