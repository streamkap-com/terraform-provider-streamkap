## Codebase Patterns
- The `docs/audits/` directory already exists with reference documentation files
- Go build command: `go build ./...` for typechecking
- Branch naming: PRD specifies `ralph/terraform-provider-audit` branch for audit work
- API client files are in `internal/api/`: auth.go (token), client.go (interface + doRequest), source.go, destination.go, etc.
- All API operations use `?secret_returned=true` to get sensitive fields in responses

---

## 2026-01-21 - US-001
- What was implemented:
  - Created `docs/audits/architecture-comparison-report.md` with proper structure
  - Added document header with title, date, auditor info
  - Added Table of Contents with 4 main sections
  - Added empty placeholder sections: Main Branch Architecture, Refactored Architecture, Comparison Matrix, Trade-offs
- Files changed:
  - Created: `docs/audits/architecture-comparison-report.md`
  - Created: `tasks/progress.txt`
- **Learnings for future iterations:**
  - The `docs/audits/` directory already existed with `backend-code-reference.md` and `entity-config-schema-audit.md`
  - These existing docs are useful references for understanding the backend and config schema
---

## 2026-01-21 - US-002
- What was implemented:
  - Documented main branch architecture pattern in `docs/audits/architecture-comparison-report.md`
  - Read 2 representative connectors via git: `postgresql.go` (589 LOC) and `snowflake.go` (503 LOC)
  - Documented manual schemas, inline CRUD, ~400-600 LOC per connector pattern
  - Documented type conversion methods: `model2ConfigMap` and `configMap2Model`
  - Added code examples and summary table
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md`
- **Learnings for future iterations:**
  - Main branch connectors can be accessed via `git show main:path/to/file`
  - Each main branch connector is ~400-600 LOC with significant code duplication
  - Key components: Resource model struct, Schema definition, CRUD operations, Type conversion methods
  - Connectors use `helper.GetTfCfgString/Int64/Bool` for type conversion from API response
---

## 2026-01-21 - US-003
- What was implemented:
  - Documented refactored three-layer architecture in `docs/audits/architecture-comparison-report.md`
  - Verified 3 generated files have `// Code generated by tfgen. DO NOT EDIT.` markers
  - Counted 52 total generated schema files (20 sources, 23 destinations, 8 transforms, 1 doc.go)
  - Documented file counts per layer with LOC statistics
  - Created ASCII architecture diagram showing three layers
  - Documented: Generated Schemas layer, Thin Wrappers layer, Shared Base Resource layer
  - Calculated ~53% LOC reduction per connector vs main branch (~235 vs ~500 LOC)
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md`
- **Learnings for future iterations:**
  - Three-layer architecture: Generated Schemas → Thin Wrappers → Shared Base Resource
  - `internal/generated/` contains 52 auto-generated files (DO NOT EDIT)
  - `internal/resource/source/*_generated.go` and `internal/resource/destination/*_generated.go` are thin wrappers (~55 LOC each)
  - `internal/resource/connector/base.go` (701 LOC) contains all shared CRUD logic with reflection
  - Wrappers implement `ConnectorConfig` interface with: GetSchema, GetFieldMappings, GetConnectorType, GetConnectorCode, GetResourceName, NewModelInstance
  - Reflection-based marshaling in base.go: `modelToConfigMap()` and `configMapToModel()`
---

## 2026-01-21 - US-004
- What was implemented:
  - Verified wrapper files exist: 20 in `internal/resource/source/`, 22 in `internal/resource/destination/`
  - Verified ConnectorConfig interface implementation in 2 spot-checked files (postgresql_generated.go, snowflake_generated.go)
  - Both wrappers have compile-time interface check: `var _ connector.ConnectorConfig = (*Config)(nil)`
  - Verified `internal/resource/connector/base.go` contains shared CRUD logic (Create/Read/Update/Delete/ImportState)
  - Verified `modelToConfigMap()` and `configMapToModel()` use reflection for generic type conversion
  - Confirmed no business logic in generated files - only Model struct, Schema function, Field mappings
  - Typecheck passed: `go build ./...`
  - Added "Layer Separation Verification" section to audit report
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md`
- **Learnings for future iterations:**
  - Wrapper files use compile-time interface compliance check pattern: `var _ Interface = (*Impl)(nil)`
  - base.go CRUD methods: Create (117-226), Read (229-313), Update (316-422), Delete (425-494)
  - Reflection helpers: extractTerraformValue(), setTerraformValue(), getStringField(), setStringField()
  - Generated files contain only: Model struct with tfsdk tags, Schema() function, FieldMappings map
---

## 2026-01-21 - US-005
- What was implemented:
  - Added comprehensive "Comparison Matrix" section to `docs/audits/architecture-comparison-report.md`
  - Created Architecture Comparison Table with 14 aspects compared (LOC, Schema definition, CRUD, Type conversion, etc.)
  - Added Quantitative Comparison table showing ~48% LOC reduction per connector
  - Added Feature Comparison table (sensitive fields, defaults, validators, enum handling, etc.)
  - Added detailed "Trade-offs" section with advantages (6 items) and disadvantages (6 items)
  - Added Risk Assessment table with likelihood, impact, and mitigation strategies
  - Added final Recommendation section with rationale
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md`
- **Learnings for future iterations:**
  - Key metrics: ~48% LOC reduction per connector, ~88% reduction in unique code per connector
  - Refactored architecture adds ~500 LOC of shared infrastructure (base.go) but saves ~4,000+ LOC across all connectors
  - Main trade-off: Reflection complexity vs. code duplication reduction
  - Primary mitigations for reflection risks: compile-time interface checks, schema backward compatibility tests, acceptance tests with VCR
---

## 2026-01-21 - US-006
- What was implemented:
  - Added comprehensive "Architectural Decisions" section to `docs/audits/architecture-comparison-report.md`
  - Documented 4 key architectural decisions with full rationale:
    1. Code Generation Approach - using `cmd/tfgen` to generate schemas from backend config
    2. Reflection-Based Marshaling - generic `modelToConfigMap()`/`configMapToModel()` in `base.go`
    3. Thin Wrapper Pattern - ~55 LOC wrapper files implementing `ConnectorConfig` interface
    4. JSON-Based Deprecations/Overrides - `deprecations.json` and `overrides.json` configuration
  - Each decision includes: Context, Decision, Rationale (4+ points), Trade-offs Accepted
  - Added code examples and implementation details
  - Updated Table of Contents with new section
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md`
- **Learnings for future iterations:**
  - `deprecations.json` contains 10 deprecated field definitions (9 PostgreSQL source, 1 Snowflake destination)
  - `overrides.json` contains 3 field overrides for complex map types (Snowflake map_string, ClickHouse map_nested, SQL Server map_nested)
  - Generator infrastructure is ~1,500 LOC in `cmd/tfgen/`
  - Key mitigations for reflection risks: compile-time interface checks (`var _ Interface = (*Impl)(nil)`)
---

## 2026-01-21 - US-007
- What was implemented:
  - Added comprehensive "API Client" section to `docs/audits/architecture-comparison-report.md`
  - Documented OAuth2 token exchange function in `internal/api/auth.go` (lines 22-45)
  - Documented Authorization header set in `doRequest()` at `client.go:84-86`
  - Verified `?secret_returned=true` parameter used across all API operations
  - Updated Table of Contents with new section
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md`
- **Learnings for future iterations:**
  - API client uses `StreamkapAPI` interface (client.go:15-53) for all operations
  - Token structure: AccessToken, Expires, ExpiresIn, RefreshToken
  - `?secret_returned=true` is used in all CRUD operations for sources, destinations, transforms, and pipelines (15 endpoints total)
  - doRequest() sets Content-Type, Accept, and Authorization headers automatically
  - doRequestWithRetry() wraps doRequest with retry logic for transient errors
---

## 2026-01-21 - US-008
- What was implemented:
  - Verified API `detail` field errors extracted in `client.go:96-110` via `APIErrorResponse` struct
  - Verified `created_from: terraform` injected on all 5 create operations (source, destination, transform, pipeline, tag)
  - Ran API unit tests: `go test -v -short ./internal/api/...` - all 21 tests passed (1.158s)
  - Added "Error Handling" section to audit report documenting error extraction pattern
  - Added "Resource Origin Tracking (created_from)" section with table of all injection points
  - Added "API Unit Test Results" section with detailed test categories and counts
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md`
- **Learnings for future iterations:**
  - `APIErrorResponse.Detail` is extracted for all non-2xx responses in `doRequest()`
  - `created_from` uses `constants.TERRAFORM` constant defined in the constants package
  - API tests cover Source CRUD (9 tests), Authentication (4 tests), and Retry Logic (8 tests including 16 sub-tests)
  - `TestCreateSource_Success` specifically verifies `created_from: terraform` in request body
---

## 2026-01-21 - US-009
- What was implemented:
  - Read `internal/api/retry.go` (121 lines)
  - Verified retry for status codes 502, 503, 504 in `gatewayPatterns` (line 31)
  - Verified exponential backoff implementation via `delay = min(delay*2, cfg.MaxDelay)` (line 116)
  - Added comprehensive "Retry Logic" subsection to audit report under API Client section
  - Documented: IsRetryableError() with 4 error categories, RetryWithBackoff() implementation, DefaultRetryConfig()
  - Updated Table of Contents with Retry Logic subsection
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md`
- **Learnings for future iterations:**
  - Retry logic is in `internal/api/retry.go` (not client.go)
  - Four categories of retryable errors: Backend Timeout, Gateway Errors (502/503/504), Network Errors, Kafka Transient
  - Default retry config: MaxRetries=3, MinDelay=10s, MaxDelay=60s
  - `doRequestWithRetry()` wraps `doRequest()` with `RetryWithBackoff()` for automatic retry handling
  - Conservative delays account for backend's internal Kafka Connect server retries
---

## 2026-01-21 - US-010
- What was implemented:
  - Ran `go test -v ./internal/helper/...` - all 10 tests passed with 50+ sub-tests (0.704s)
  - Added comprehensive "Helper Functions" section to `docs/audits/architecture-comparison-report.md`
  - Documented type conversion functions: GetTfCfgString, GetTfCfgInt64, GetTfCfgBool, GetTfCfgListString
  - Documented deprecated field migration function (MigrateDeprecatedValues)
  - Documented nil map safety handling for all helper functions
  - Updated Table of Contents with new section
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md`
- **Learnings for future iterations:**
  - Helper functions are in `internal/helper/helper.go` (type conversion) and `internal/helper/deprecated.go` (migration)
  - GetTfCfgInt64 handles both float64 (JSON encoding) and string values
  - All helper functions return appropriate null/zero values for nil maps (safe defaults)
  - Test files: `internal/helper/helper_test.go` and `internal/helper/deprecated_test.go`
---

## 2026-01-21 - US-011
- What was implemented:
  - Read `internal/resource/connector/base.go` (701 lines)
  - Verified `modelToConfigMap()` function exists at lines 501-542 (reflection-based model → config map conversion)
  - Verified `configMapToModel()` function exists at lines 544-581 (reflection-based config map → model conversion)
  - Verified timeout context in all CRUD methods: Create (126-141), Update (325-340), Delete (434-449)
  - Verified import state passthrough at lines 496-499 using `resource.ImportStatePassthroughID`
  - Added comprehensive "Base Resource" section to `docs/audits/architecture-comparison-report.md`
  - Updated Table of Contents with new section
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md`
- **Learnings for future iterations:**
  - Base resource implements 3 interfaces: resource.Resource, ResourceWithConfigure, ResourceWithImportState
  - Timeouts use `helper.DefaultCreateTimeout`, `helper.DefaultUpdateTimeout`, `helper.DefaultDeleteTimeout`
  - Type extraction handled by `extractTerraformValue()` (lines 583-628) supporting String, Int64, Bool, Float64, List
  - Type setting handled by `setTerraformValue()` (lines 630-666) using helper functions
  - String field helpers: `getStringField()` (669-686) and `setStringField()` (688-701) for ID/Name/Connector fields
---

## 2026-01-21 - US-012
- What was implemented:
  - Ran `go test -v -run 'TestSchemaBackwardsCompatibility' ./internal/provider/...` - all 16 tests passed (0.862s)
  - Verified no "required attribute removed" errors in any test
  - Verified no "optional changed to required" errors in any test
  - Added comprehensive "Schema Backward Compatibility Tests" section to `docs/audits/architecture-comparison-report.md`
  - Documented all 16 test results with baseline/current attribute counts
  - Documented that SQL Server source has 1 new additive attribute (backward-compatible)
  - Updated Table of Contents with new section
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md`
- **Learnings for future iterations:**
  - Schema compatibility tests are in `internal/provider/schema_compat_test.go`
  - Tests compare baseline v2.1.18 schemas against current refactored schemas
  - Test naming: `TestSchemaBackwardsCompatibility_{Source|Destination|Transform}{ConnectorName}`
  - Tests verify 298 total attributes across 6 sources, 7 destinations, and 3 transforms
  - New additive attributes are allowed (INFO log), removed/changed-to-required attributes fail
---

## 2026-01-21 - US-013
- What was implemented:
  - Read `cmd/tfgen/deprecations.json` and counted 10 deprecated field entries
  - Spot-checked 2 PostgreSQL deprecated fields for proper DeprecationMessage (insert_static_key_field_1, insert_static_key_value_1)
  - Spot-checked Snowflake auto_schema_creation deprecation for proper DeprecationMessage
  - Added comprehensive "Deprecated Fields" section to `docs/audits/architecture-comparison-report.md`
  - Documented deprecations registry, field mappings, implementation architecture, and design characteristics
  - Updated Table of Contents with new section
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md`
- **Learnings for future iterations:**
  - Deprecated fields are NOT in generated files (`internal/generated/`) - they're in wrapper files (`internal/resource/source/*_generated.go`, `internal/resource/destination/*_generated.go`)
  - Wrapper files add deprecated attributes via `GetSchema()` method which extends the generated schema
  - Deprecated and new attributes map to the SAME API field name (e.g., both `insert_static_key_field_1` and `transforms_insert_static_key1_static_field` map to `transforms.InsertStaticKey1.static.field`)
  - `deprecations.json` contains 10 entries: 9 PostgreSQL source, 1 Snowflake destination
---

## 2026-01-21 - US-014
- What was implemented:
  - Checked for STREAMKAP_CLIENT_ID and STREAMKAP_SECRET environment variables - both not set
  - Added comprehensive "Migration Tests" section to `docs/audits/architecture-comparison-report.md`
  - Documented status as SKIPPED due to missing credentials
  - Documented required environment variables and the command that would be run
  - Added "Workaround for Credential-less Verification" section referencing schema compatibility tests
  - Added recommendation for manual migration test execution before production release
  - Updated Table of Contents with new section
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md`
- **Learnings for future iterations:**
  - Migration tests require TF_ACC=1, STREAMKAP_CLIENT_ID, and STREAMKAP_SECRET environment variables
  - Migration tests use the pattern `TestAcc.*Migration` for test discovery
  - Schema backward compatibility tests provide confidence even without credentials
  - Migration tests verify no unexpected plan changes when upgrading from v2.1.18 to refactored provider
---

## 2026-01-21 - US-015
- What was implemented:
  - Read `cmd/tfgen/parser.go` (429 lines) to verify code generator parser implementation
  - Verified `ParseConnectorConfig()` function reads `configuration.latest.json` format (lines 100-113)
  - Verified `user_defined: true` filter logic exists via `IsUserDefined()` (lines 117-119) and `UserDefinedEntries()` (lines 368-376)
  - Verified field metadata extraction: control (line 65), type (line 66), default (lines 163-241), required (lines 128-133)
  - Added comprehensive "Code Generator Parser" section to `docs/audits/architecture-comparison-report.md`
  - Updated Table of Contents with new section
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md` (+223 lines)
- **Learnings for future iterations:**
  - Parser is in `cmd/tfgen/parser.go`, generator is in `cmd/tfgen/generator.go`
  - `ValueObject` struct (lines 63-81) contains all value-related metadata: control, type, default, raw_values, min/max/step
  - `TerraformType()` method (lines 245-264) maps backend controls to Terraform types (string→types.String, number→types.Int64, etc.)
  - `TerraformAttributeName()` method converts backend names to Terraform-friendly names (removes `.user.defined` suffix, replaces dots/hyphens with underscores)
  - Parser supports conditional fields via `Condition` struct and `IsConditional()` method
---

## 2026-01-21 - US-016
- What was implemented:
  - Read `cmd/tfgen/generator.go` (993 lines) to verify code generator type mapping
  - Verified `string` → `types.String` mapping in `TerraformType()` (parser.go lines 247-248)
  - Verified `password` → `types.String` (Sensitive) mapping via `IsSensitive()` (parser.go lines 121-125)
  - Verified `number` → `types.Int64` mapping (parser.go lines 249-251)
  - Verified `boolean`/`toggle` → `types.Bool` mapping (parser.go lines 252-253)
  - Verified `encrypt=true` generates `Sensitive=true` via `IsSensitive()` check in `entryToFieldData()` (generator.go line 644)
  - Added comprehensive "Code Generator Type Mapping" section to `docs/audits/architecture-comparison-report.md` (+230 lines)
  - Updated Table of Contents with new section
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md`
- **Learnings for future iterations:**
  - Type mapping happens in two places: parser (TerraformType constants) and generator (schema attribute assignment)
  - `IsSensitive()` returns true for `encrypt=true` OR `control=password` - both conditions make a field sensitive
  - Generator has special port field override: fields named `port` or ending in `_port` are forced to Int64 type
  - Validator generation: `one-select` → `OneOf` validator, `slider` → `Between` validator
  - Test coverage exists in `parser_test.go` for `TestIsSensitive` with 4 test cases
---

## 2026-01-21 - US-017
- What was implemented:
  - Read `cmd/tfgen/overrides.json` and verified structure (3 field overrides)
  - Read `cmd/tfgen/deprecations.json` and verified structure (10 deprecated field definitions)
  - Verified at least one `map_string` override exists: Snowflake `auto_qa_dedupe_table_mapping`
  - Verified at least one `map_nested` override exists: ClickHouse `topics_config_map` and SQL Server `snapshot_custom_table_config`
  - Added comprehensive "Override and Deprecation System" section to `docs/audits/architecture-comparison-report.md` (+195 lines)
  - Documented JSON structures, override types, deprecation registry, and application flow diagram
  - Updated Table of Contents with new section (section 14)
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md`
- **Learnings for future iterations:**
  - `overrides.json` contains 3 entries: 1 map_string (Snowflake), 2 map_nested (ClickHouse, SQL Server)
  - `deprecations.json` contains 10 entries: 9 PostgreSQL source, 1 Snowflake destination
  - map_nested overrides support validators (e.g., `int64_at_least`) in their nested_fields
  - Both deprecated and new attributes map to the same API field name for backward compatibility
---

## 2026-01-21 - US-018
- What was implemented:
  - Checked `STREAMKAP_BACKEND_PATH` environment variable - not set
  - Added section 15 "Code Regeneration Test" to `docs/audits/architecture-comparison-report.md`
  - Documented test status as SKIPPED due to missing backend path
  - Documented the command that would be run with backend access
  - Added alternative verification indicators (schema tests pass, build success, generated files present)
  - Added recommendation for running regeneration test with backend before production release
  - Updated Table of Contents with new section
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md` (+74 lines)
  - Modified: `tasks/prd.json` (marked US-018 as passes: true)
- **Learnings for future iterations:**
  - `STREAMKAP_BACKEND_PATH` should point to the local clone of `python-be-streamkap` backend repo
  - Backend repo contains `configuration.latest.json` files used by `go generate ./...`
  - Regeneration test verifies that running `go generate` produces no diff in `internal/generated/`
  - Alternative verification: schema compatibility tests provide confidence even without backend access
---

## 2026-01-21 - US-019
- What was implemented:
  - Verified existing `.env.example` file already contains most core variables
  - Added `STREAMKAP_BACKEND_PATH` environment variable section to `.env.example`
  - Connector-specific placeholder vars already existed for 6 source and 7 destination connectors
  - Added comprehensive "Environment Variables" section (section 16) to `docs/audits/architecture-comparison-report.md`
  - Documented 4 core settings, 1 code generation setting, 3 testing options, and 13 connector-specific variable groups
  - Updated Table of Contents with new section
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `.env.example` (+9 lines - added STREAMKAP_BACKEND_PATH section)
  - Modified: `docs/audits/architecture-comparison-report.md` (+120 lines)
  - Modified: `tasks/prd.json` (marked US-019 as passes: true)
- **Learnings for future iterations:**
  - `.env.example` file existed but was missing `STREAMKAP_BACKEND_PATH` for code generation
  - Environment variables are found via `os.Getenv()` calls - grep for pattern to find all usages
  - Key locations: `provider.go` (core auth), `*_resource_test.go` (connector credentials), `internal/generated/doc.go` (backend path)
  - Connector test variables follow pattern: `TF_VAR_source_<connector>_<field>` or `TF_VAR_destination_<connector>_<field>`
---

## 2026-01-21 - US-020
- What was implemented:
  - Verified raw `database.hostname` computed field is NOT exposed in generated schemas (correct - only `database.hostname.user.defined` is exposed)
  - Verified raw `database.port` computed field is NOT exposed in generated schemas (correct - only `database.port.user.defined` is exposed)
  - Verified `connection.url` exclusion - Databricks uses `.user.defined`, Weaviate uses direct URL (intentional design)
  - Documented `IsUserDefined()` filter in parser that ensures only `user_defined: true` fields become Terraform attributes
  - Added field mapping statistics: 145 total `.user.defined` mappings across 38 generated files
  - Confirmed transform resources correctly have 0 `.user.defined` fields (they're not database connectors)
  - Added comprehensive "Dynamic Field Exclusion" section (section 17) to `docs/audits/architecture-comparison-report.md`
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md` (+156 lines)
  - Modified: `tasks/prd.json` (marked US-020 as passes: true)
- **Learnings for future iterations:**
  - Dynamic field exclusion is handled by `IsUserDefined()` in `cmd/tfgen/parser.go:117-119`
  - Only fields with `user_defined: true` in backend config become Terraform attributes
  - `.user.defined` suffix in field name is stripped by `TerraformAttributeName()` to create clean attribute names
  - Not all fields have a computed counterpart - some fields (credentials, config options) are direct user inputs without `.user.defined` suffix
  - Transform resources don't use `.user.defined` pattern - they're configuration-only, not database connectors
---

## 2026-01-21 - US-021
- What was implemented:
  - Verified 5 source connector schemas exist: AlloyDB, DB2, DocumentDB, DynamoDB, Elasticsearch
  - Listed first 10 generated source files (confirmed all batch 1 connectors present)
  - Added "Source Connector Schema Verification (Batch 1)" section to `docs/audits/architecture-comparison-report.md`
  - Documented line counts for each file: AlloyDB (330), DB2 (186), DocumentDB (157), DynamoDB (196), Elasticsearch (149)
  - Total: 1,018 lines of generated code for batch 1
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md` (+50 lines)
  - Modified: `tasks/prd.json` (marked US-021 as passes: true)
- **Learnings for future iterations:**
  - All 20 source connector generated files are in `internal/generated/source_*.go`
  - Generated file naming convention: `source_<connectorname>.go` (all lowercase)
  - Line counts vary from ~150 LOC (simpler connectors) to ~330 LOC (complex connectors like AlloyDB)
  - Use `wc -l internal/generated/source_*.go` to get line counts for all source schemas
---

## 2026-01-21 - US-022
- What was implemented:
  - Verified 5 source connector schemas exist: KafkaDirect, MariaDB, MongoDB, MongoDBHosted, MySQL
  - Note: File naming uses lowercase without underscores (kafkadirect, mongodbhosted not kafka_direct, mongodb_hosted)
  - Line counts: KafkaDirect (95), MariaDB (245), MongoDB (222), MongoDBHosted (222), MySQL (314) = 1,098 total
  - Added "Source Connector Schema Verification (Batch 2)" section to audit report
  - Updated Table of Contents with sections 18 and 19
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md` (+47 lines)
  - Modified: `tasks/prd.json` (marked US-022 as passes: true)
- **Learnings for future iterations:**
  - Generated file naming convention: all lowercase, no underscores between words (e.g., `source_kafkadirect.go` not `source_kafka_direct.go`)
  - Schema file sizes vary from ~95 LOC (simple connectors like KafkaDirect) to ~314 LOC (complex connectors like MySQL)
  - MongoDB and MongoDBHosted have identical LOC (222) - likely similar schema structure with different connection handling
---

## 2026-01-21 - US-023
- What was implemented:
  - Verified 5 source connector schemas exist: Oracle, OracleAWS, PlanetScale, PostgreSQL, Redis
  - Line counts: Oracle (223), OracleAWS (216), PlanetScale (195), PostgreSQL (372), Redis (236) = 1,242 total
  - PostgreSQL has highest LOC due to extensive deprecated field mappings (9 deprecated fields)
  - Added "Source Connector Schema Verification (Batch 3)" section to audit report with cumulative progress table
  - Updated Table of Contents with section 20
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md` (+56 lines)
  - Modified: `tasks/prd.json` (marked US-023 as passes: true)
- **Learnings for future iterations:**
  - PostgreSQL has highest LOC (372) among all sources due to 9 deprecated field mappings in deprecations.json
  - Cumulative progress: 15/20 source connectors verified (3,358 LOC total)
  - Oracle and OracleAWS are separate connectors (for self-hosted vs AWS RDS Oracle)
---

## 2026-01-21 - US-024
- What was implemented:
  - Verified 5 final source connector schemas exist: S3, SQLServerAWS, Supabase, Vitess, Webhook
  - Note: SQL Server connector is named `source_sqlserveraws.go` (AWS variant)
  - Line counts: S3 (167), SQLServerAWS (306), Supabase (330), Vitess (199), Webhook (117) = 1,119 total
  - Added "Source Connector Schema Verification (Batch 4)" section (section 21) to audit report
  - Added "Complete Source Connector Summary" table with all 4 batches (4,477 LOC total)
  - Added "All 20 Source Schemas Verified ✅" section with complete file listing
  - Updated Table of Contents with section 21
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md` (+86 lines)
  - Modified: `tasks/prd.json` (marked US-024 as passes: true)
- **Learnings for future iterations:**
  - All 20 source connector schemas are now verified (4,477 LOC total)
  - SQL Server connector is named `sqlserveraws` (AWS variant) not just `sqlserver`
  - Complete source schema coverage: AlloyDB, DB2, DocumentDB, DynamoDB, Elasticsearch, KafkaDirect, MariaDB, MongoDB, MongoDBHosted, MySQL, Oracle, OracleAWS, PlanetScale, PostgreSQL, Redis, S3, SQLServerAWS, Supabase, Vitess, Webhook
---

## 2026-01-21 - US-025
- What was implemented:
  - Verified 6 destination connector schemas exist: AzBlob, BigQuery, ClickHouse, CockroachDB, Databricks, DB2
  - Line counts: AzBlob (147), BigQuery (124), ClickHouse (179), CockroachDB (196), Databricks (196), DB2 (164) = 1,006 total
  - Added "Destination Connector Schema Verification (Batch 1)" section (section 22) to audit report
  - Documented total destination files: 23 files with 3,889 LOC total
  - Updated Table of Contents with new section
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md` (+68 lines)
  - Modified: `tasks/prd.json` (marked US-025 as passes: true)
- **Learnings for future iterations:**
  - All 23 destination connector generated files are in `internal/generated/destination_*.go`
  - Generated file naming convention: `destination_<connectorname>.go` (all lowercase)
  - Destination schemas range from ~71 LOC (simple like KafkaDirect) to ~278 LOC (complex like Weaviate)
  - Total destination LOC: 3,889 vs source LOC: 4,477
---

## 2026-01-21 - US-026
- What was implemented:
  - Verified 6 destination connector schemas exist: GCS, HTTPSink, Iceberg, Kafka, KafkaDirect, Motherduck
  - Line counts: GCS (123), HTTPSink (260), Iceberg (152), Kafka (109), KafkaDirect (71), Motherduck (154) = 869 total
  - HTTPSink has highest LOC (260) in batch - complex HTTP webhook configuration
  - KafkaDirect has lowest LOC (71) - minimal schema without schema registry
  - Added "Destination Connector Schema Verification (Batch 2)" section (section 23) to audit report
  - Updated Table of Contents with new section
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md` (+68 lines)
  - Modified: `tasks/prd.json` (marked US-026 as passes: true)
- **Learnings for future iterations:**
  - Cumulative destination progress: 12/23 destination connectors verified (1,875 LOC total)
  - Remaining batches: Batch 3 (MySQL, Oracle, PostgreSQL, R2, Redis) and Batch 4 (Redshift, S3, Snowflake, SQLServer, Starburst) + Weaviate
  - HTTPSink destination is for real-time webhook event delivery, has extensive configuration options
---

## 2026-01-21 - US-027
- What was implemented:
  - Verified 5 destination connector schemas exist: MySQL, Oracle, PostgreSQL, R2, Redis
  - Line counts: MySQL (187), Oracle (187), PostgreSQL (237), R2 (137), Redis (133) = 881 total
  - PostgreSQL has highest LOC (237) in batch - comprehensive destination with CDC support
  - Redis has lowest LOC (133) - minimal schema for in-memory data store
  - Added "Destination Connector Schema Verification (Batch 3)" section (section 24) to audit report
  - Updated Table of Contents with new section
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md` (+66 lines)
  - Modified: `tasks/prd.json` (marked US-027 as passes: true)
- **Learnings for future iterations:**
  - Cumulative destination progress: 17/23 destination connectors verified (2,756 LOC total)
  - Remaining: Batch 4 (Redshift, S3, Snowflake, SQLServer, Starburst) + Weaviate (6 connectors)
  - R2 is Cloudflare's S3-compatible object storage
---

## 2026-01-21 - US-028
- What was implemented:
  - Verified 6 final destination connector schemas exist: Redshift, S3, Snowflake, SQLServer, Starburst, Weaviate
  - Line counts: Redshift (139), S3 (142), Snowflake (238), SQLServer (194), Starburst (142), Weaviate (278) = 1,133 total
  - Added "Destination Connector Schema Verification (Batch 4)" section (section 25) to audit report
  - Added complete "All 23 Destination Schemas Verified" summary table with all connectors and LOC
  - Added "Destination vs Source Schema Comparison" showing 43 total connectors, 8,366 LOC combined
  - Updated Table of Contents with new section
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md` (+108 lines)
  - Modified: `tasks/prd.json` (marked US-028 as passes: true)
- **Learnings for future iterations:**
  - All 23 destination connector schemas verified (3,889 LOC total)
  - All 20 source connector schemas verified (4,477 LOC total)
  - Combined: 43 source+destination connectors with 8,366 LOC of generated schema code
  - Weaviate has highest LOC (278) among destinations - vector DB with complex configuration
  - Snowflake destination (238 LOC) has extensive options for data warehouse integration
---

## 2026-01-21 - US-029
- What was implemented:
  - Verified all 6 required transform schemas exist: Enrich, EnrichAsync, FanOut, MapFilter, Rollup, SqlJoin
  - Discovered 2 additional transform schemas: ToastHandling, UnNesting (total 8 transform schemas)
  - Added comprehensive "Transform Resource Schema Verification" section (section 26) to audit report
  - Documented line counts: Required transforms 686 LOC, all transforms 900 LOC
  - Updated Complete Entity Schema Summary: 51 entities with 9,266 LOC total
  - Updated Table of Contents with new section
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md` (+114 lines)
  - Modified: `tasks/prd.json` (marked US-029 as passes: true)
- **Learnings for future iterations:**
  - Transform schemas are in `internal/generated/transform_*.go` (8 files total)
  - All transform schemas have similar LOC (~100-136) indicating consistent complexity
  - EnrichAsync is largest transform (136 LOC), Enrich is smallest (89 LOC)
  - Two additional transforms beyond required 6: ToastHandling (PostgreSQL TOAST column handling), UnNesting (array/nested record flattening)
  - Total entity count: 20 sources + 23 destinations + 8 transforms = 51 generated schemas
---

## 2026-01-21 - US-030
- What was implemented:
  - Created acceptance test for AlloyDB source: `TestAccSourceAlloyDBResource` in `source_alloydb_resource_test.go`
  - Created acceptance test for DB2 source: `TestAccSourceDB2Resource` in `source_db2_resource_test.go`
  - Created acceptance test for DocumentDB source: `TestAccSourceDocumentDBResource` in `source_documentdb_resource_test.go`
  - All tests implement basic CRUD operations: Create/Read, ImportState, Update/Read, Delete (automatic)
  - All tests use `tf-acc-test-` prefix for resource names (e.g., "tf-acc-test-source-alloydb")
  - All tests include `t.Skip()` for graceful handling when credentials not set
  - Typecheck passed: `go build ./...`
- Files changed:
  - Created: `internal/provider/source_alloydb_resource_test.go` (~115 lines)
  - Created: `internal/provider/source_db2_resource_test.go` (~100 lines)
  - Created: `internal/provider/source_documentdb_resource_test.go` (~93 lines)
  - Modified: `tasks/prd.json` (marked US-030 as passes: true)
- **Learnings for future iterations:**
  - Acceptance test pattern: Use `os.Getenv()` at package level for env vars, `t.Skip()` at test start
  - AlloyDB is PostgreSQL-compatible (Google Cloud), uses same schema fields as PostgreSQL
  - DB2 uses port 50000 by default, schemas are uppercase (e.g., "STREAMKAP")
  - DocumentDB uses connection string pattern similar to MongoDB, with array/document encoding options
  - Test variable naming convention: `TF_VAR_source_{connector}_{field}` (e.g., `TF_VAR_source_alloydb_hostname`)
  - Existing tests (e.g., DynamoDB, PostgreSQL) didn't have skip logic - added skip pattern for new tests
---

## 2026-01-21 - US-031
- What was implemented:
  - Created acceptance test for Elasticsearch source: `TestAccSourceElasticsearchResource` in `source_elasticsearch_resource_test.go`
  - Created acceptance test for MariaDB source: `TestAccSourceMariaDBResource` in `source_mariadb_resource_test.go`
  - Created acceptance test for MongoDB Hosted source: `TestAccSourceMongoDBHostedResource` in `source_mongodbhosted_resource_test.go`
  - All tests implement basic CRUD operations: Create/Read, ImportState, Update/Read, Delete (automatic)
  - All tests use `tf-acc-test-` prefix for resource names
  - All tests include `t.Skip()` for graceful handling when credentials not set
  - Typecheck passed: `go build ./...`
- Files changed:
  - Created: `internal/provider/source_elasticsearch_resource_test.go` (~95 lines)
  - Created: `internal/provider/source_mariadb_resource_test.go` (~105 lines)
  - Created: `internal/provider/source_mongodbhosted_resource_test.go` (~85 lines)
  - Modified: `tasks/prd.json` (marked US-031 as passes: true)
- **Learnings for future iterations:**
  - Elasticsearch source uses `es_host`, `es_scheme`, `es_port` naming convention (es prefix)
  - MariaDB is similar to MySQL but uses `snapshot_gtid` instead of `snapshot_mode` for GTID configuration
  - MongoDB Hosted uses `mongodb_connection_string` (single connection string) vs MongoDB self-hosted which uses separate host/port
  - Test environment variables: `TF_VAR_source_elasticsearch_host`, `TF_VAR_source_mariadb_hostname`, `TF_VAR_source_mongodbhosted_connection_string`
---

## 2026-01-21 - US-032
- What was implemented:
  - Created acceptance test for Oracle source: `TestAccSourceOracleResource` in `source_oracle_resource_test.go`
  - Created acceptance test for Oracle AWS (RDS) source: `TestAccSourceOracleAWSResource` in `source_oracleaws_resource_test.go`
  - Created acceptance test for PlanetScale source: `TestAccSourcePlanetScaleResource` in `source_planetscale_resource_test.go`
  - All tests implement basic CRUD operations: Create/Read, ImportState, Update/Read, Delete (automatic)
  - All tests use `tf-acc-test-` prefix for resource names
  - All tests include `t.Skip()` for graceful handling when credentials not set
  - Typecheck passed: `go build ./...`
- Files changed:
  - Created: `internal/provider/source_oracle_resource_test.go` (~105 lines)
  - Created: `internal/provider/source_oracleaws_resource_test.go` (~105 lines)
  - Created: `internal/provider/source_planetscale_resource_test.go` (~95 lines)
  - Modified: `tasks/prd.json` (marked US-032 as passes: true)
- **Learnings for future iterations:**
  - Oracle self-hosted requires `database_pdb_name` for container databases (CDB), OracleAWS does not have this field
  - Oracle uses uppercase schema names by convention (e.g., "STREAMKAP" not "streamkap")
  - Both Oracle connectors require `signal_data_collection_schema_or_database` and `heartbeat_data_collection_schema_or_database` fields
  - PlanetScale is Vitess-based, uses `vitess_keyspace` and `vitess_tablet_type` (MASTER/REPLICA/RDONLY)
  - PlanetScale default port is 443 (HTTPS) not 3306
  - Test variable naming: `TF_VAR_source_oracle_hostname`, `TF_VAR_source_oracleaws_hostname`, `TF_VAR_source_planetscale_hostname`
---

## 2026-01-21 - US-033
- What was implemented:
  - Created acceptance test for Redis source: `TestAccSourceRedisResource` in `source_redis_resource_test.go`
  - Created acceptance test for S3 source: `TestAccSourceS3Resource` in `source_s3_resource_test.go`
  - Created acceptance test for Supabase source: `TestAccSourceSupabaseResource` in `source_supabase_resource_test.go`
  - All tests implement basic CRUD operations: Create/Read, ImportState, Update/Read, Delete (automatic)
  - All tests use `tf-acc-test-` prefix for resource names
  - All tests include `t.Skip()` for graceful handling when credentials not set
  - Typecheck passed: `go build ./...`
- Files changed:
  - Created: `internal/provider/source_redis_resource_test.go` (~120 lines)
  - Created: `internal/provider/source_s3_resource_test.go` (~115 lines)
  - Created: `internal/provider/source_supabase_resource_test.go` (~130 lines)
  - Modified: `tasks/prd.json` (marked US-033 as passes: true)
- **Learnings for future iterations:**
  - Redis source uses `redis_host`, `redis_port`, `redis_password` naming convention
  - Redis supports two connector class types: "Stream" (Redis Streams) and "Keys" (key-based monitoring)
  - Redis Stream has delivery modes: "At Least Once" and "At Most Once"
  - S3 source uses `aws_access_key_id`, `aws_secret_access_key`, `aws_s3_bucket_name` for AWS credentials
  - S3 has file formats: json, csv, avro
  - S3 has cleanup policies: LogCleanupPolicy (just log) and DeleteCleanupPolicy (delete after processing)
  - Supabase is PostgreSQL-based (uses same schema as AlloyDB/PostgreSQL with different defaults)
  - Supabase has `snapshot_read_only` default "Yes" for read replica support
  - Test environment variables: `TF_VAR_source_redis_host`, `TF_VAR_source_s3_bucket_name`, `TF_VAR_source_supabase_hostname`
---

## 2026-01-21 - US-034
- What was implemented:
  - Created acceptance test for Vitess source: `TestAccSourceVitessResource` in `source_vitess_resource_test.go`
  - Created acceptance test for Webhook source: `TestAccSourceWebhookResource` in `source_webhook_resource_test.go`
  - Vitess test implements full CRUD with VTGate and VTCtld configuration
  - Webhook test implements full CRUD with no external credentials required (generates webhook_url and api_key on create)
  - All tests use `tf-acc-test-` prefix for resource names
  - Vitess test includes `t.Skip()` for graceful handling when credentials not set
  - Webhook test runs without skip since it has no external dependencies
  - Typecheck passed: `go build ./...`
- Files changed:
  - Created: `internal/provider/source_vitess_resource_test.go` (~105 lines)
  - Created: `internal/provider/source_webhook_resource_test.go` (~65 lines)
  - Modified: `tasks/prd.json` (marked US-034 as passes: true)
- **Learnings for future iterations:**
  - Vitess source has two connection points: VTGate (database_hostname:15991) and VTCtld (vitess_vtctld_host:15999)
  - Vitess and PlanetScale share similar schema (vitess_keyspace, vitess_tablet_type) but PlanetScale doesn't have VTCtld fields
  - Webhook source is unique - only requires `name` field, all other fields are optional/computed
  - Webhook generates `webhook_url` and `api_key` after creation (server-side generated)
  - Webhook has no external credentials, making it the simplest source to test
  - Vitess requires 3 env vars: `TF_VAR_source_vitess_hostname`, `TF_VAR_source_vitess_vtctld_host`, `TF_VAR_source_vitess_vtctld_password`
  - All 20 source acceptance tests are now complete (AlloyDB, DB2, DocumentDB, DynamoDB, Elasticsearch, KafkaDirect, MariaDB, MongoDB, MongoDBHosted, MySQL, Oracle, OracleAWS, PlanetScale, PostgreSQL, Redis, S3, SQLServer, Supabase, Vitess, Webhook)
---

## 2026-01-21 - US-035
- What was implemented:
  - Created acceptance test for AzBlob destination: `TestAccDestinationAzblobResource` in `destination_azblob_resource_test.go`
  - Created acceptance test for BigQuery destination: `TestAccDestinationBigqueryResource` in `destination_bigquery_resource_test.go`
  - Created acceptance test for CockroachDB destination: `TestAccDestinationCockroachdbResource` in `destination_cockroachdb_resource_test.go`
  - All tests implement basic CRUD operations: Create/Read, ImportState, Update/Read, Delete (automatic)
  - All tests use `tf-acc-test-` prefix for resource names (e.g., "tf-acc-test-destination-azblob")
  - All tests include `t.Skip()` for graceful handling when credentials not set
  - Typecheck passed: `go build ./...`
- Files changed:
  - Created: `internal/provider/destination_azblob_resource_test.go` (~95 lines)
  - Created: `internal/provider/destination_bigquery_resource_test.go` (~92 lines)
  - Created: `internal/provider/destination_cockroachdb_resource_test.go` (~114 lines)
  - Modified: `tasks/prd.json` (marked US-035 as passes: true)
- **Learnings for future iterations:**
  - AzBlob uses `azblob_connection_string` (SAS token or account key) and `azblob_container_name` for Azure Blob Storage
  - AzBlob has file format options: json, csv, avro, parquet (default: json)
  - BigQuery uses `bigquery_json` (service account JSON content), `table_name_prefix` (dataset), and `bigquery_region`
  - BigQuery has 30+ region options (us-central1, us-east1, EU, US, etc.)
  - CockroachDB uses standard database fields with default port 26257 (not 5432 like PostgreSQL)
  - CockroachDB has `schema_evolution` (basic/none), `insert_mode` (insert/upsert), and `primary_key_mode` (none/record_key/record_value)
  - Test environment variables: `TF_VAR_destination_azblob_connection_string`, `TF_VAR_destination_bigquery_json`, `TF_VAR_destination_cockroachdb_hostname`
  - First batch of 3 destination acceptance tests complete (AzBlob, BigQuery, CockroachDB)
---

## 2026-01-21 - US-036
- What was implemented:
  - Created acceptance test for DB2 destination: `TestAccDestinationDb2Resource` in `destination_db2_resource_test.go`
  - Created acceptance test for GCS destination: `TestAccDestinationGcsResource` in `destination_gcs_resource_test.go`
  - Created acceptance test for HTTP Sink destination: `TestAccDestinationHttpsinkResource` in `destination_httpsink_resource_test.go`
  - All tests implement basic CRUD operations: Create/Read, ImportState, Update/Read, Delete (automatic)
  - All tests use `tf-acc-test-` prefix for resource names
  - All tests include `t.Skip()` for graceful handling when credentials not set
  - Typecheck passed: `go build ./...`
- Files changed:
  - Created: `internal/provider/destination_db2_resource_test.go` (~114 lines)
  - Created: `internal/provider/destination_gcs_resource_test.go` (~90 lines)
  - Created: `internal/provider/destination_httpsink_resource_test.go` (~105 lines)
  - Modified: `tasks/prd.json` (marked US-036 as passes: true)
- **Learnings for future iterations:**
  - DB2 destination uses default port 50000 (standard for DB2)
  - DB2 has `schema_evolution` (basic/none), `insert_mode` (insert/upsert), and `primary_key_mode` (none/record_key/record_value)
  - GCS destination uses `gcs_credentials_json` (service account JSON with escaped quotes) and `gcs_bucket_name`
  - GCS has file format options: CSV, JSON Lines, JSON Array, Parquet (note: uppercase "CSV" not "csv")
  - GCS has compression options: none, gzip, snappy, zstd
  - HTTP Sink has extensive batching configuration: `batching_enabled`, `batch_max_size`, `batch_buffering_enabled`, `batch_max_time_ms`
  - HTTP Sink supports three authorization types: none, static (with `http_headers_authorization`), oauth2 (with oauth2_* fields)
  - HTTP Sink `errors_tolerance` cannot be used when batching is enabled (documented in schema description)
  - Test environment variables: `TF_VAR_destination_db2_hostname`, `TF_VAR_destination_gcs_credentials_json`, `TF_VAR_destination_httpsink_url`
  - Second batch of 3 destination acceptance tests complete (DB2, GCS, HTTPSink)
---

## 2026-01-21 - US-037
- What was implemented:
  - Created acceptance test for Kafka Direct destination: `TestAccDestinationKafkadirectResource` in `destination_kafkadirect_resource_test.go`
  - Created acceptance test for Motherduck destination: `TestAccDestinationMotherduckResource` in `destination_motherduck_resource_test.go`
  - Created acceptance test for MySQL destination: `TestAccDestinationMysqlResource` in `destination_mysql_resource_test.go`
  - All tests implement basic CRUD operations: Create/Read, ImportState, Update/Read, Delete (automatic)
  - All tests use `tf-acc-test-` prefix for resource names
  - All tests include `t.Skip()` for graceful handling when credentials not set
  - Typecheck passed: `go build ./...`
- Files changed:
  - Created: `internal/provider/destination_kafkadirect_resource_test.go` (~80 lines)
  - Created: `internal/provider/destination_motherduck_resource_test.go` (~95 lines)
  - Created: `internal/provider/destination_mysql_resource_test.go` (~115 lines)
  - Modified: `tasks/prd.json` (marked US-037 as passes: true)
- **Learnings for future iterations:**
  - Kafka Direct destination is minimal: only requires `name`, `password`, and `whitelist_ips` fields
  - Kafka Direct has no schema registry configuration - it's for direct Kafka integration
  - Motherduck is a serverless DuckDB cloud platform; uses `motherduck_token` and `motherduck_catalog`
  - Motherduck has `ingestion_mode` (upsert/append), `hard_delete`, and topic name transformation fields
  - MySQL destination uses standard database fields: `database_hostname`, `database_port`, `connection_username`, `connection_password`
  - MySQL destination has `tasks_max` range 1-10 (unlike other destinations with 1-25)
  - Test environment variables: `TF_VAR_destination_kafkadirect_password`, `TF_VAR_destination_motherduck_token`, `TF_VAR_destination_mysql_hostname`
  - Third batch of 3 destination acceptance tests complete (KafkaDirect, Motherduck, MySQL)
---

## 2026-01-21 - US-038
- What was implemented:
  - Created acceptance test for Oracle destination: `TestAccDestinationOracleResource` in `destination_oracle_resource_test.go`
  - Created acceptance test for R2 destination: `TestAccDestinationR2Resource` in `destination_r2_resource_test.go`
  - Created acceptance test for Redis destination: `TestAccDestinationRedisResource` in `destination_redis_resource_test.go`
  - All tests implement basic CRUD operations: Create/Read, ImportState, Update/Read, Delete (automatic)
  - All tests use `tf-acc-test-` prefix for resource names
  - All tests include `t.Skip()` for graceful handling when credentials not set
  - Typecheck passed: `go build ./...`
- Files changed:
  - Created: `internal/provider/destination_oracle_resource_test.go` (~115 lines)
  - Created: `internal/provider/destination_r2_resource_test.go` (~100 lines)
  - Created: `internal/provider/destination_redis_resource_test.go` (~105 lines)
  - Modified: `tasks/prd.json` (marked US-038 as passes: true)
- **Learnings for future iterations:**
  - Oracle destination uses default port 1521 (standard for Oracle)
  - Oracle destination has same schema evolution/insert mode/primary key mode pattern as MySQL/DB2/CockroachDB
  - R2 is Cloudflare's S3-compatible object storage; uses `r2_account` for Cloudflare account ID
  - R2 uses S3-compatible credentials: `aws_access_key_id`, `aws_secret_access_key`, `aws_s3_bucket_name`
  - R2 format options: "JSON Lines", "JSON Array", "Parquet" (note: title case, not lowercase)
  - R2 compression options: none, gzip, snappy, zstd
  - Redis destination uses `redis_host`, `redis_port`, `redis_username`, `redis_password` naming convention
  - Redis `redis_key_data_type` options: Stream, List, Hash (note: title case)
  - Test environment variables: `TF_VAR_destination_oracle_hostname`, `TF_VAR_destination_r2_account`, `TF_VAR_destination_redis_host`
  - Fourth batch of 3 destination acceptance tests complete (Oracle, R2, Redis)
---

## 2026-01-21 - US-039
- What was implemented:
  - Created acceptance test for Redshift destination: `TestAccDestinationRedshiftResource` in `destination_redshift_resource_test.go`
  - Created acceptance test for SQL Server destination: `TestAccDestinationSqlserverResource` in `destination_sqlserver_resource_test.go`
  - Created acceptance test for Starburst destination: `TestAccDestinationStarburstResource` in `destination_starburst_resource_test.go`
  - All tests implement basic CRUD operations: Create/Read, ImportState, Update/Read, Delete (automatic)
  - All tests use `tf-acc-test-` prefix for resource names
  - All tests include `t.Skip()` for graceful handling when credentials not set
  - Typecheck passed: `go build ./...`
- Files changed:
  - Created: `internal/provider/destination_redshift_resource_test.go` (~115 lines)
  - Created: `internal/provider/destination_sqlserver_resource_test.go` (~125 lines)
  - Created: `internal/provider/destination_starburst_resource_test.go` (~110 lines)
  - Modified: `tasks/prd.json` (marked US-039 as passes: true)
- **Learnings for future iterations:**
  - Redshift uses `aws_redshift_domain`, `aws_redshift_port` (default 5439), `aws_redshift_database` naming convention
  - Redshift is a columnar data warehouse optimized for analytics queries
  - SQL Server destination uses default port 1433 (standard for SQL Server)
  - SQL Server destination has same schema evolution/insert mode/primary key mode pattern as MySQL/Oracle/DB2/CockroachDB
  - SQL Server uses `table_name_prefix` for schema (e.g., "dbo" for default schema)
  - Starburst is S3-based analytics platform; uses AWS S3 credentials for storage
  - Starburst format options: "CSV", "JSON Lines", "JSON Array", "Parquet" (note: title case)
  - Starburst compression options: none, gzip, snappy, zstd
  - Starburst uses `file_name_template` with Kafka placeholders: `{{topic}}-{{partition}}-{{start_offset}}`
  - Test environment variables: `TF_VAR_destination_redshift_domain`, `TF_VAR_destination_sqlserver_hostname`, `TF_VAR_destination_starburst_access_key_id`
  - Fifth batch of 3 destination acceptance tests complete (Redshift, SQLServer, Starburst)
  - All 23 destination acceptance tests are now complete!
---

## 2026-01-21 - US-040
- What was implemented:
  - Created acceptance test for EnrichAsync transform: `TestAccTransformEnrichAsyncResource_basic` in `transform_enrich_async_resource_test.go`
  - Created acceptance test for FanOut transform: `TestAccTransformFanOutResource_basic` in `transform_fan_out_resource_test.go`
  - Created acceptance test for Rollup transform: `TestAccTransformRollupResource_basic` in `transform_rollup_resource_test.go`
  - All tests implement basic CRUD operations: Create/Read, ImportState, Update/Read, Delete (automatic)
  - All tests use `tf-acc-test-` prefix for resource names (e.g., "tf-acc-test-transform-enrich-async")
  - All tests follow same pattern as existing `transform_enrich_resource_test.go`
  - Typecheck passed: `go build ./...`
- Files changed:
  - Created: `internal/provider/transform_enrich_async_resource_test.go` (~75 lines)
  - Created: `internal/provider/transform_fan_out_resource_test.go` (~65 lines)
  - Created: `internal/provider/transform_rollup_resource_test.go` (~65 lines)
  - Modified: `tasks/prd.json` (marked US-040 as passes: true)
- **Learnings for future iterations:**
  - Transform resources share similar schema structure: name, transforms_language, transforms_input_topic_pattern, transforms_output_topic_pattern, transforms_input_serialization_format, transforms_output_serialization_format
  - EnrichAsync is unique - has additional `transforms_async_timeout_ms` and `transforms_async_capacity` fields; supports JavaScript or Python
  - FanOut only supports JavaScript as `transforms_language`
  - Rollup only supports SQL as `transforms_language`
  - Valid serialization format values are title case: "Any", "Avro", "Json" (not lowercase)
  - Transform tests don't require skip logic for credentials - they work like the Webhook source (no external dependencies)
  - All 6 required transform types now have acceptance tests: Enrich, EnrichAsync, FanOut, MapFilter, Rollup, SqlJoin
---

## 2026-01-21 - US-041
- What was implemented:
  - Verified 16 schema snapshot files exist in `internal/provider/testdata/schemas/` directory
  - Ran schema compatibility tests: all 16 tests pass with 298 total attributes tracked
  - Documented snapshot inventory, statistics, and test results in audit report
  - Added "Schema Snapshots" section (section 27) to `docs/audits/architecture-comparison-report.md`
  - Updated Table of Contents with new section
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `docs/audits/architecture-comparison-report.md` (+140 lines - Schema Snapshots section)
  - Modified: `tasks/prd.json` (marked US-041 as passes: true)
- **Learnings for future iterations:**
  - Schema snapshots are in `internal/provider/testdata/schemas/` directory (not `testdata/snapshots/`)
  - 16 snapshot files: 6 sources, 7 destinations, 3 transforms covering 298 total attributes
  - `UPDATE_SNAPSHOTS=1` environment variable triggers snapshot regeneration
  - macOS `com.apple.provenance` extended attribute can prevent file writes; use `xattr -c` to clear
  - SQL Server source has 1 new additive attribute (`snapshot_custom_table_config`) - backward-compatible
  - Schema compatibility test pattern: `TestSchemaBackwardsCompatibility_{Source|Destination|Transform}{ConnectorName}`
---

## 2026-01-21 - US-042
- What was implemented:
  - Added `ListSources` method to `StreamkapAPI` interface in `internal/api/client.go`
  - Implemented `ListSources` function in `internal/api/source.go` (calls GET /sources?secret_returned=true)
  - Updated `sweepSources` function in `internal/provider/sweep_test.go` to use actual API calls
  - Sweeper lists all sources and deletes those matching test resource prefixes
  - Uses existing `isTestResource()` helper that checks: tf-acc-test-, tf-migration-test-, test-source-, test-destination-
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `internal/api/client.go` (+1 line - interface method)
  - Modified: `internal/api/source.go` (+21 lines - ListSources implementation)
  - Modified: `internal/provider/sweep_test.go` (+23 lines, -4 lines - sweepSources implementation)
  - Modified: `tasks/prd.json` (marked US-042 as passes: true)
- **Learnings for future iterations:**
  - API list endpoints use same response structure as get-by-id (GetSourceResponse with pagination)
  - `GET /sources` without ID returns paginated list of all sources
  - Sweep tests use `//go:build sweep` build tag, run with `go test -tags=sweep`
  - `isTestResource()` helper already handles multiple test prefixes for robustness
  - Error handling in sweeper collects all errors rather than failing on first error
---

## 2026-01-21 - US-043
- What was implemented:
  - Added `ListDestinations` method to `StreamkapAPI` interface in `internal/api/client.go`
  - Implemented `ListDestinations` function in `internal/api/destination.go` (calls GET /destinations?secret_returned=true)
  - Updated `sweepDestinations` function in `internal/provider/sweep_test.go` to use actual API calls
  - Sweeper lists all destinations and deletes those matching test resource prefixes
  - Uses existing `isTestResource()` helper that checks: tf-acc-test-, tf-migration-test-, test-source-, test-destination-
  - Typecheck passed: `go build ./...` and `go build -tags=sweep ./...`
- Files changed:
  - Modified: `internal/api/client.go` (+1 line - interface method)
  - Modified: `internal/api/destination.go` (+21 lines - ListDestinations implementation)
  - Modified: `internal/provider/sweep_test.go` (+28 lines, -1 line - sweepDestinations implementation)
  - Modified: `tasks/prd.json` (marked US-043 as passes: true)
- **Learnings for future iterations:**
  - Destination API follows identical pattern to Source API (GetDestinationResponse with same pagination structure)
  - `GET /destinations` without ID returns paginated list of all destinations
  - Sweeper already registered in init() - only implementation was placeholder
  - All three sweepers (sources, destinations, pipelines) are registered with dependencies: pipelines depends on sources and destinations
---

## 2026-01-21 - US-044
- What was implemented:
  - Added `ListTransforms` method to `StreamkapAPI` interface in `internal/api/client.go`
  - Implemented `ListTransforms` function in `internal/api/transform.go` (calls GET /transforms?secret_returned=true)
  - Added `ListPipelines` method to `StreamkapAPI` interface in `internal/api/client.go`
  - Implemented `ListPipelines` function in `internal/api/pipeline.go` (calls GET /pipelines?secret_returned=true)
  - Implemented `sweepTransforms` function in `internal/provider/sweep_test.go`
  - Updated `sweepPipelines` function to use actual API calls (was placeholder before)
  - Registered `streamkap_transform` sweeper in init()
  - Updated pipeline sweeper dependencies to include transforms
  - Typecheck passed: `go build ./...` and `go build -tags=sweep ./...`
- Files changed:
  - Modified: `internal/api/client.go` (+2 lines - interface methods)
  - Modified: `internal/api/transform.go` (+21 lines - ListTransforms implementation)
  - Modified: `internal/api/pipeline.go` (+21 lines - ListPipelines implementation)
  - Modified: `internal/provider/sweep_test.go` (+70 lines, -2 lines - sweepTransforms and sweepPipelines)
  - Modified: `tasks/prd.json` (marked US-044 as passes: true)
- **Learnings for future iterations:**
  - Transform API uses same paginated response pattern: `GetTransformResponse` with Total, PageSize, Page, Result fields
  - Pipeline API uses same paginated response pattern: `GetPipelineResponse` with Total, PageSize, Page, Result fields
  - `GET /transforms` and `GET /pipelines` without ID return paginated list of all resources
  - Pipeline sweeper now depends on transforms in addition to sources and destinations
  - All four sweepers (sources, destinations, transforms, pipelines) are now fully implemented with API calls
---

## 2026-01-21 - US-045
- What was implemented:
  - Created `internal/provider/smoke_test.go` with smoke tests for connectors without credentials
  - Identified 5 connectors likely missing test credentials: Oracle (source), BigQuery, Redshift, Starburst, Motherduck (destinations)
  - Created individual `TestSmoke*` tests for each of the 5 connectors
  - Each smoke test verifies: Schema compilation, Model instantiation, Field mappings validity
  - Created `TestSmokeAllConnectorSchemas` that validates all 51 registered resources in the provider
  - Documented all smoke-tested connectors in `docs/audits/architecture-comparison-report.md`
  - Added section 28 "Smoke Tests" to audit report with detailed results
  - Typecheck passed: `go build ./...`
  - All smoke tests pass: `go test -v -run 'TestSmoke' ./internal/provider/...`
- Files changed:
  - Created: `internal/provider/smoke_test.go` (+275 lines)
  - Modified: `docs/audits/architecture-comparison-report.md` (+145 lines - Smoke Tests section)
  - Modified: `tasks/prd.json` (marked US-045 as passes: true)
- **Learnings for future iterations:**
  - Smoke tests provide confidence in generated code without needing API access
  - Use `reflect.TypeOf(model).Elem()` to get struct type from pointer for field inspection
  - `resource.MetadataResponse` contains `TypeName` which gives the full Terraform resource name
  - All 51 resources can be retrieved from provider's `Resources()` method
  - Schema smoke tests verify: computed `id`/`connector` fields exist, required `name` field exists
  - Model smoke tests verify: model is a pointer to struct, has `tfsdk` tags
  - Field mapping smoke tests verify: mappings are non-nil, non-empty, all keys/values non-empty
---

## 2026-01-21 - US-046
- What was implemented:
  - Created `internal/provider/error_handling_test.go` with comprehensive API error tests
  - Implemented 6 tests for 401 Unauthorized errors:
    - `TestAPIError401_MissingToken` - requests without token
    - `TestAPIError401_ExpiredToken` - expired token handling
    - `TestAPIError401_InvalidCredentials` - invalid client credentials
    - `TestAPIError401_CreateSource` - 401 on create operations
    - `TestAPIError401_UpdateDestination` - 401 on update operations
    - `TestAPIError401_DeleteTransform` - 401 on delete operations
  - Implemented 9 tests for 404 Not Found errors:
    - `TestAPIError404_GetSource`, `TestAPIError404_GetDestination`, `TestAPIError404_GetPipeline`
    - `TestAPIError404_GetTransform`, `TestAPIError404_GetTag`, `TestAPIError404_GetTopic`
    - `TestAPIError404_DeleteSource`, `TestAPIError404_UpdateSource`, `TestAPIError404_DeleteDestination`
  - Implemented 2 error message propagation tests:
    - `TestErrorMessagePropagation_DetailField` - table-driven test with 4 sub-tests
    - `TestErrorMessagePropagation_401vs404` - verifies distinct error messages
  - Typecheck passed: `go build ./...`
- Files changed:
  - Created: `internal/provider/error_handling_test.go` (~597 lines)
  - Modified: `tasks/prd.json` (marked US-046 as passes: true)
- **Learnings for future iterations:**
  - API endpoints have different URL patterns:
    - Sources/Destinations: `GET /resources/{id}?secret_returned=true`
    - Transforms GET: `GET /transforms/{id}?secret_returned=true&unwind_topics=false`
    - Transforms DELETE: `DELETE /transforms?id={id}` (query param, not path param)
    - Tags: `GET /tags?tag_ids={id}` (no secret_returned)
    - Topics: `GET /topics/{id}` (no secret_returned)
  - Use `httpmock` package for API mocking in tests
  - `api.APIErrorResponse.Detail` field is extracted for all non-2xx responses
  - Tests without credentials can use the `api.NewClient(&api.Config{BaseURL: baseURL})` pattern
---

## 2026-01-21 - US-047
- What was implemented:
  - Added 9 tests for 422 Unprocessable Entity (validation error) handling:
    - `TestAPIError422_MissingRequiredField` - missing required field validation
    - `TestAPIError422_InvalidEnumValue` - invalid enum value rejection
    - `TestAPIError422_InvalidPortRange` - port out of valid range rejection
    - `TestAPIError422_InvalidFieldType` - type mismatch validation
    - `TestAPIError422_UpdateValidation` - validation on update operations
    - `TestAPIError422_DuplicateName` - duplicate resource name rejection
    - `TestAPIError422_TransformInvalidConfig` - transform-specific validation
    - `TestAPIError422_PipelineInvalidReferences` - invalid source/destination references
    - `TestAPIError422_NoRetry` - verifies 422 errors are NOT retried (single request)
  - Added 11 tests for 5xx server error handling:
    - `TestAPIError500_InternalServerError` - 500 handling
    - `TestAPIError502_BadGateway` - 502 Bad Gateway (retryable)
    - `TestAPIError503_ServiceUnavailable` - 503 Service Unavailable (retryable)
    - `TestAPIError504_GatewayTimeout` - 504 Gateway Timeout (retryable)
    - `TestAPIError5xx_CreateOperation` - 5xx on create operations
    - `TestAPIError5xx_UpdateOperation` - 5xx on update operations
    - `TestAPIError5xx_DeleteOperation` - 5xx on delete operations
    - `TestAPIError5xx_KafkaConnectTimeout` - Kafka Connect specific timeout
    - `TestAPIError5xx_RetryBehavior` - 8 sub-tests verifying `IsRetryableError()` logic
    - `TestAPIError5xx_NoResponseBody` - 5xx with unparseable response body
  - All tests use `httpmock` for API mocking without real credentials
  - Typecheck passed: `go build ./...`
- Files changed:
  - Modified: `internal/provider/error_handling_test.go` (+669 lines)
  - Modified: `tasks/prd.json` (marked US-047 as passes: true)
- **Learnings for future iterations:**
  - 422 Unprocessable Entity is used for validation errors (missing required fields, invalid enums, type mismatches)
  - 422 errors are NOT retryable - they fail immediately (validation errors won't fix themselves on retry)
  - 5xx errors have different retryability: 502/503/504 are retryable, 500 is NOT retryable
  - `api.IsRetryableError()` checks for specific patterns: "502", "503", "504", "bad gateway", "service unavailable", "gateway timeout", "kafkaconnecttimeout"
  - `api.CreateTransformRequest` uses `Transform` field (not `Name`) - name goes in Config map
  - `api.Pipeline` uses nested `Source` and `Destination` structs with ID, Name, Connector fields
  - When server returns unparseable body, JSON decode error is returned (not the HTTP status code error)
---
